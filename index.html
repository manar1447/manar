<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مقياس منار للتميز التربوي</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #f3f4f6; }
        .scale-btn { transition: all 0.2s; }
        .scale-btn.active { transform: scale(1.1); font-weight: bold; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .print-visible { display: none; }
        @media print {
            .no-print { display: none; }
            .print-visible { display: block; }
            body { background-color: white; }
            .card { border: 1px solid #ddd; box-shadow: none; break-inside: avoid; }
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header -->
    <header class="bg-teal-700 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div>
                <h1 class="text-2xl font-bold">مقياس منار للتميز التربوي</h1>
                <p class="text-teal-200 text-sm hidden md:block">الإصدار النصي الكامل - أداة قياس الأثر والنضج المؤسسي</p>
            </div>
            <div class="text-left">
                <div class="text-sm opacity-80">النتيجة الحالية</div>
                <div class="text-3xl font-bold" id="sticky-total">0 <span class="text-sm font-normal">/ 180</span></div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 max-w-5xl">

        <!-- Introduction Section (Collapsible) -->
        <section class="bg-white rounded-lg shadow-md mb-8 overflow-hidden border-t-4 border-teal-600 no-print">
            <div class="p-6 cursor-pointer bg-gray-50 hover:bg-gray-100 transition flex justify-between items-center" onclick="toggleSection('intro-content', 'intro-icon')">
                <h2 class="text-xl font-bold text-teal-800 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    أولاً: التعريف بالمقياس وفلسفة البناء
                </h2>
                <svg id="intro-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
            </div>
            <div id="intro-content" class="hidden p-6 border-t border-gray-200 text-gray-700 space-y-4 leading-relaxed">
                <p>في ظل التحولات المتسارعة التي يشهدها القطاع غير الربحي، برزت الحاجة إلى أداة قياس نوعية تتجاوز مجرد "رصد الأنشطة" إلى "قياس الأثر". يأتي "مقياس منار" كأداة تشخيصية رشيقة (Lean Tool)، صُممت خصيصاً لتقييم نضج الممارسات التربوية والإدارية في المؤسسات الخيرية.</p>
                
                <div class="grid md:grid-cols-2 gap-6 mt-4">
                    <div class="bg-teal-50 p-4 rounded-lg">
                        <h3 class="font-bold text-teal-800 mb-2">بطاقة تعريف المقياس</h3>
                        <ul class="list-disc list-inside text-sm space-y-1">
                            <li><strong>اسم الأداة:</strong> مقياس منار للتميز التربوي.</li>
                            <li><strong>الغرض:</strong> أداة تشخيصية وتطويرية لتقييم نضج المؤسسات، ونقلها من العشوائية إلى التخطيط الاستراتيجي.</li>
                        </ul>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h3 class="font-bold text-blue-800 mb-2">فلسفة البناء</h3>
                        <p class="text-sm">يجمع المقياس بين عمق المضمون القيمي وجودة الهيكل التنظيمي (EFQM). يستند إلى المواءمة التكاملية بين المعايير العالمية (ISO 21001)، والامتثال المحلي (NCNP)، والعمق القيمي الأصيل.</p>
                    </div>
                </div>

                <h3 class="font-bold text-gray-800 mt-4">لماذا هذا المقياس؟</h3>
                <ul class="list-disc list-inside space-y-1 text-sm">
                    <li><strong>مختصر ومركز:</strong> يستهدف الـ 20٪ من العمليات التي تحقق 80٪ من الأثر.</li>
                    <li><strong>موجه بالأثر:</strong> ينتقل من رصد الجهود إلى قياس النواتج.</li>
                    <li><strong>أداة للتطوير:</strong> يوفر خارطة حرارية لنقاط القوة والتحسين.</li>
                </ul>
            </div>
        </section>

        <!-- Scoring Guide Legend -->
        <section class="bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-8 text-sm text-indigo-900 flex flex-wrap gap-4 items-center justify-between sticky top-20 z-40 shadow-sm">
            <div class="font-bold flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                دليل التقييم (مسطرة القياس):
            </div>
            <div class="flex gap-2 flex-wrap">
                <span class="px-2 py-1 bg-white rounded border border-indigo-100"><strong class="text-red-600">1</strong> بدائي/غائب</span>
                <span class="px-2 py-1 bg-white rounded border border-indigo-100"><strong class="text-orange-500">2</strong> ناشئ</span>
                <span class="px-2 py-1 bg-white rounded border border-indigo-100"><strong class="text-yellow-600">3</strong> مفعّل</span>
                <span class="px-2 py-1 bg-white rounded border border-indigo-100"><strong class="text-green-600">4</strong> مؤسسي</span>
                <span class="px-2 py-1 bg-white rounded border border-indigo-100"><strong class="text-teal-700">5</strong> ريادي/متميز</span>
            </div>
        </section>

        <!-- Dynamic Form Content -->
        <div id="app-container"></div>

        <!-- Dashboard / Results Section -->
        <section class="mt-12 bg-white rounded-xl shadow-xl overflow-hidden print-break-before">
            <div class="bg-gray-800 text-white p-6">
                <h2 class="text-2xl font-bold flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg>
                    لوحة النتائج النهائية (Dashboard)
                </h2>
            </div>
            
            <div class="p-8">
                <!-- Scores Grid -->
                <div class="grid md:grid-cols-3 gap-6 mb-8 text-center">
                    <div class="bg-gray-50 p-6 rounded-lg border-b-4 border-blue-500">
                        <div class="text-gray-500 text-sm mb-1">المجال الأول</div>
                        <h3 class="font-bold text-gray-800 mb-2">الممكنات القيادية</h3>
                        <div class="text-3xl font-bold text-blue-600"><span id="res-domain1">0</span> <span class="text-base text-gray-400 font-normal">/ 65</span></div>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg border-b-4 border-green-500">
                        <div class="text-gray-500 text-sm mb-1">المجال الثاني</div>
                        <h3 class="font-bold text-gray-800 mb-2">العمليات التربوية</h3>
                        <div class="text-3xl font-bold text-green-600"><span id="res-domain2">0</span> <span class="text-base text-gray-400 font-normal">/ 55</span></div>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg border-b-4 border-purple-500">
                        <div class="text-gray-500 text-sm mb-1">المجال الثالث</div>
                        <h3 class="font-bold text-gray-800 mb-2">النتائج والأثر</h3>
                        <div class="text-3xl font-bold text-purple-600"><span id="res-domain3">0</span> <span class="text-base text-gray-400 font-normal">/ 60</span></div>
                    </div>
                </div>

                <!-- Final Score & Maturity -->
                <div class="bg-gradient-to-l from-teal-50 to-white border border-teal-100 rounded-xl p-8 text-center mb-8">
                    <h3 class="text-xl font-bold text-gray-700 mb-4">النتيجة النهائية ومستوى النضج</h3>
                    <div class="text-6xl font-extrabold text-teal-700 mb-2"><span id="res-total">0</span></div>
                    <div class="text-gray-400 mb-6">من أصل 180 درجة</div>
                    
                    <div id="maturity-badge" class="inline-block px-8 py-3 rounded-full text-lg font-bold bg-gray-200 text-gray-600">
                        بانتظار التقييم...
                    </div>
                    <p id="maturity-desc" class="mt-4 text-gray-600 max-w-2xl mx-auto"></p>
                </div>

                <!-- Actions -->
                <div class="flex justify-center gap-4 no-print">
                    <button onclick="window.print()" class="px-6 py-3 bg-gray-800 hover:bg-gray-900 text-white rounded-lg flex items-center gap-2 shadow-lg transition">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" /></svg>
                        طباعة التقرير / حفظ PDF
                    </button>
                    <button onclick="resetForm()" class="px-6 py-3 bg-white border border-red-200 text-red-600 hover:bg-red-50 rounded-lg flex items-center gap-2 transition">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>
                        إعادة تعيين
                    </button>
                </div>
            </div>
        </section>

        <footer class="text-center text-gray-400 text-sm py-8 mt-8 border-t">
            <p>مقياس منار للتميز التربوي © - جميع الحقوق محفوظة</p>
        </footer>

    </main>

    <script>
        // Data Structure based on the provided text
        const scaleData = [
            {
                id: "d1",
                title: "المجال الأول: الممكنات القيادية (Enablers)",
                maxScore: 65,
                color: "blue",
                axes: [
                    {
                        title: "المحور (1-1): التوجه الاستراتيجي والحوكمة",
                        indicators: [
                            { id: 1, name: "وضوح الرؤية والالتزام بها", proof: "الرؤية التربوية معلنة ومكتوبة، ويستوعبها جميع العاملين، مع وجود التزام عاطفي وعملي بها." },
                            { id: 2, name: "المواءمة الاستراتيجية", proof: "الرسالة والأهداف الاستراتيجية مرتبطة بشكل مباشر بالأهداف التربوية والقيمية الكبرى للجهة." },
                            { id: 3, name: "التخطيط التشغيلي", proof: "وجود خطة سنوية موثقة تتضمن برامج محددة، ميزانيات، وجداول زمنية متوافقة مع الاستراتيجية." },
                            { id: 4, name: "اللوائح والسياسات", proof: "وجود لوائح مكتوبة تنظم العمل التربوي (وليس الإداري فقط)، تحدد الصلاحيات والمسؤوليات بدقة." },
                            { id: 5, name: "المرونة وإدارة المخاطر", proof: "قدرة الخطة والنظام الإداري على استيعاب المتغيرات الطارئة والتعامل مع الأزمات." }
                        ]
                    },
                    {
                        title: "المحور (1-2): إدارة رأس المال البشري",
                        indicators: [
                            { id: 6, name: "التأسيس والتهيئة", proof: "وجود برنامج (Induction) منهجي لتأهيل الموظفين والمربين الجدد قبل استلام مهامهم." },
                            { id: 7, name: "التدريب والتطوير المستمر", proof: "تنفيذ برامج تدريبية دورية لسد الفجوات المهارية والتربوية لدى العاملين." },
                            { id: 8, name: "نقل المعرفة والتعاقب", proof: "وجود آلية منظمة لانتقال الخبرات من القدامى للجدد، وتوفر صف ثاني من القيادات التربوية." },
                            { id: 9, name: "التمكين والدعم", proof: "دعم المؤسسة للعاملين في مسار التعلم الذاتي، وتوفير الموارد التي تعينهم على أداء مهامهم." }
                        ]
                    },
                    {
                        title: "المحور (1-3): الثقافة المؤسسية والقيمية",
                        indicators: [
                            { id: 10, name: "القيادة بالقدوة", proof: "تمثّل القيادات والعاملين للقيم المؤسسية في سلوكهم اليومي وقراراتهم." },
                            { id: 11, name: "المرجعية القيمية", proof: "وضوح المرجعية القيمية والأخلاقية التي يحتكم إليها الجميع عند الاختلاف أو اتخاذ القرار." },
                            { id: 12, name: "اللغة المشتركة", proof: "شيوع مصطلحات ومفاهيم تربوية موحدة (لغة مشتركة) تسهل التفاهم بين فرق العمل." },
                            { id: 13, name: "البيئة المحفزة", proof: "وجود بيئة علاقات داخلية صحية تحفز على العطاء، الاحترام المتبادل، والعمل بروح الفريق." }
                        ]
                    }
                ]
            },
            {
                id: "d2",
                title: "المجال الثاني: العمليات التربوية (The Journey)",
                maxScore: 55,
                color: "green",
                axes: [
                    {
                        title: "المحور (2-1): تصميم وتخطيط البرامج",
                        indicators: [
                            { id: 14, name: "رصد الاحتياج", proof: "تصميم البرامج بناءً على دراسات واقعية لاحتياجات الفئة المستهدفة وخصائصهم العمرية." },
                            { id: 15, name: "الشمولية والعدالة", proof: "تغطية الخدمات لجميع الشرائح المستهدفة بعدالة، ومراعاة الفروق الفردية في التصميم." },
                            { id: 16, name: "تحديد المستهدفات", proof: "وضوح الأهداف السلوكية والتربوية لكل برنامج أو نشاط قبل البدء فيه." },
                            { id: 17, name: "دمج القيم في التصميم", proof: "القيم ليست 'محاضرة' بل مدمجة في صلب الأنشطة والفعاليات بشكل مقصود ومخطط له." }
                        ]
                    },
                    {
                        title: "المحور (2-2): جودة التنفيذ والبيئة",
                        indicators: [
                            { id: 18, name: "بيئة التعلم الآمنة", proof: "توفر بيئة (مادية/رقمية) تحقق الأمان النفسي والجسدي للمستفيد، وتكون جاذبة ومحفزة." },
                            { id: 19, name: "كفاءة الموارد", proof: "توفر الموارد المالية واللوجستية الكافية لتنفيذ البرامج بالجودة المطلوبة وعدم تعثرها." },
                            { id: 20, name: "الانضباط المعياري", proof: "التزام المنفذين بالخطط الزمنية والمعايير التربوية المعتمدة في دليل البرنامج." },
                            { id: 21, name: "خلو الموانع", proof: "خلو البرامج والمحتوى المقدم من أي ممارسات أو رسائل تتنافى مع القيم والهوية." }
                        ]
                    },
                    {
                        title: "المحور (2-3): الرقابة وضمان الجودة",
                        indicators: [
                            { id: 22, name: "أدوات القياس", proof: "وجود أدوات علمية واضحة (استبانات، ملاحظة، اختبارات) لاختبار جودة المخرجات." },
                            { id: 23, name: "التقارير المبنية على البيانات", proof: "انتظام رفع التقارير الفنية والتربوية التي تعتمد على بيانات وأرقام حقيقية." },
                            { id: 24, name: "التصحيح الفوري", proof: "وجود آلية سريعة لمعالجة الملاحظات والأخطاء التي تظهر أثناء التنفيذ وعدم ترحيلها." }
                        ]
                    }
                ]
            },
            {
                id: "d3",
                title: "المجال الثالث: النتائج والأثر (Impact & Results)",
                maxScore: 60,
                color: "purple",
                axes: [
                    {
                        title: "المحور (3-1): الأثر التربوي والسلوكي",
                        indicators: [
                            { id: 25, name: "التغير السلوكي (Outcome)", proof: "توفر شواهد تثبت تحسن سلوكيات أو مهارات المستفيدين كنتيجة مباشرة للبرامج." },
                            { id: 26, name: "تحقيق الأهداف", proof: "نسبة تحقق الأهداف التربوية المخطط لها مسبقاً (مقارنة المستهدف بالمحقق)." },
                            { id: 27, name: "تعزيز القيم", proof: "مدى رسوخ القيم المستهدفة لدى المستفيدين وظهورها في تعاملاتهم." }
                        ]
                    },
                    {
                        title: "المحور (3-2): رضا المعنيين",
                        indicators: [
                            { id: 28, name: "قياس الرضا", proof: "قياس رضا (المستفيدين، أولياء الأمور، المجتمع) بشكل دوري ومنهجي موثق." },
                            { id: 29, name: "الاستجابة للملاحظات", proof: "وجود قنوات فعالة للشكاوى والمقترحات، واستخدامها فعلياً في تطوير البرامج." },
                            { id: 30, name: "استمرار الولاء", proof: "نسبة استمرار المستفيدين في برامج الجهة، وتفاعلهم مع أنشطتها المستقبلية." }
                        ]
                    },
                    {
                        title: "المحور (3-3): الاستدامة والابتكار",
                        indicators: [
                            { id: 31, name: "الابتكار في الخدمات", proof: "تقديم مبادرات وحلول تربوية إبداعية غير تقليدية تواكب لغة العصر." },
                            { id: 32, name: "التطوير المستمر", proof: "إدخال تحسينات دورية على الخدمات بناءً على نتائج القياس والتقييم." },
                            { id: 33, name: "الاستدامة المالية/الإدارية", proof: "وجود خطط تضمن استمرار البرامج الناجحة وعدم توقفها بانتهاء التمويل المؤقت." },
                            { id: 34, name: "استدامة الأثر", proof: "استمرار أثر البرامج في حياة المستفيدين حتى بعد انتهاء علاقتهم المباشرة بالجهة." }
                        ]
                    },
                    {
                        title: "المحور (3-4): العائد المجتمعي",
                        indicators: [
                            { id: 35, name: "السمعة المؤسسية", proof: "تقدير المجتمع المحلي للدور التربوي الذي تقوم به الجهة." },
                            { id: 36, name: "نشر المعرفة", proof: "مساهمة الجهة في نشر الممارسات الإيجابية أو نقل تجربتها لجهات أخرى ووجود الشراكات الفاعلة." }
                        ]
                    }
                ]
            }
        ];

        // Render the App
        function renderApp() {
            const container = document.getElementById('app-container');
            let html = '';

            scaleData.forEach(domain => {
                html += `
                    <div class="mb-8 rounded-xl overflow-hidden shadow-lg bg-white card">
                        <div class="bg-${domain.color}-600 text-white p-4">
                            <h2 class="text-xl font-bold">${domain.title}</h2>
                            <p class="text-${domain.color}-100 text-sm mt-1">المجموع الكلي للمجال: ${domain.maxScore} درجة</p>
                        </div>
                        <div class="p-6">
                `;

                domain.axes.forEach(axis => {
                    html += `
                        <div class="mb-6 last:mb-0">
                            <h3 class="text-lg font-bold text-gray-800 mb-4 pb-2 border-b border-gray-100">${axis.title}</h3>
                            <div class="space-y-6">
                    `;
                    
                    axis.indicators.forEach(ind => {
                        html += `
                            <div class="bg-gray-50 rounded-lg p-4 hover:shadow-md transition card" id="card-${ind.id}">
                                <div class="flex flex-col md:flex-row justify-between gap-4">
                                    <div class="flex-1">
                                        <div class="flex items-center gap-2 mb-2">
                                            <span class="bg-${domain.color}-100 text-${domain.color}-700 text-xs font-bold px-2 py-1 rounded-full">#${ind.id}</span>
                                            <h4 class="font-bold text-gray-900">${ind.name}</h4>
                                        </div>
                                        <p class="text-sm text-gray-600 leading-relaxed"><span class="font-semibold text-gray-500">مظهر التحقق:</span> ${ind.proof}</p>
                                    </div>
                                    <div class="flex flex-col items-center justify-center min-w-[200px]">
                                        <div class="flex gap-1 justify-center w-full no-print">
                                            ${[1,2,3,4,5].map(val => `
                                                <button 
                                                    onclick="setScore(${ind.id}, ${val}, '${domain.id}')" 
                                                    class="scale-btn w-10 h-10 rounded-full border-2 border-${domain.color}-200 bg-white text-gray-500 hover:border-${domain.color}-500 hover:text-${domain.color}-600 focus:outline-none flex items-center justify-center font-medium"
                                                    id="btn-${ind.id}-${val}"
                                                    title="${getTooltip(val)}"
                                                >${val}</button>
                                            `).join('')}
                                        </div>
                                        <div class="text-xs text-gray-400 mt-2 font-medium no-print">التقييم</div>
                                        <div class="print-visible text-lg font-bold">الدرجة: <span id="print-score-${ind.id}">_</span> / 5</div>
                                    </div>
                                </div>
                            </div>
                        `;
                    });

                    html += `</div></div>`;
                });

                html += `</div></div>`;
            });

            container.innerHTML = html;
        }

        function getTooltip(val) {
            const tips = ["بدائي", "ناشئ", "مفعّل", "مؤسسي", "متميز"];
            return tips[val-1];
        }

        // State Management
        const scores = {};
        
        function setScore(id, val, domainId) {
            scores[id] = val;
            
            // Visual Update
            // Reset buttons for this question
            for(let i=1; i<=5; i++) {
                const btn = document.getElementById(`btn-${id}-${i}`);
                btn.className = btn.className.replace('bg-teal-600 text-white border-teal-600 active', 'bg-white text-gray-500 border-gray-200');
                // Restore original base classes
                if(domainId === 'd1') btn.classList.add('border-blue-200');
                if(domainId === 'd2') btn.classList.add('border-green-200');
                if(domainId === 'd3') btn.classList.add('border-purple-200');
            }
            
            // Highlight selected
            const activeBtn = document.getElementById(`btn-${id}-${val}`);
            activeBtn.className = `scale-btn active w-10 h-10 rounded-full border-2 focus:outline-none flex items-center justify-center font-bold text-white shadow-lg transform scale-110`;
            
            // Color based on domain
            if(domainId === 'd1') activeBtn.classList.add('bg-blue-600', 'border-blue-600');
            if(domainId === 'd2') activeBtn.classList.add('bg-green-600', 'border-green-600');
            if(domainId === 'd3') activeBtn.classList.add('bg-purple-600', 'border-purple-600');

            // Update Print View
            document.getElementById(`print-score-${id}`).innerText = val;

            calculateTotals();
        }

        function calculateTotals() {
            let total = 0;
            let d1Total = 0, d2Total = 0, d3Total = 0;

            // Domain 1: IDs 1-13
            for(let i=1; i<=13; i++) d1Total += (scores[i] || 0);
            // Domain 2: IDs 14-24
            for(let i=14; i<=24; i++) d2Total += (scores[i] || 0);
            // Domain 3: IDs 25-36
            for(let i=25; i<=36; i++) d3Total += (scores[i] || 0);

            total = d1Total + d2Total + d3Total;

            // Update UI
            document.getElementById('res-domain1').innerText = d1Total;
            document.getElementById('res-domain2').innerText = d2Total;
            document.getElementById('res-domain3').innerText = d3Total;
            
            animateValue('res-total', parseInt(document.getElementById('res-total').innerText), total, 500);
            document.getElementById('sticky-total').innerText = total;

            updateMaturityLevel(total);
        }

        function updateMaturityLevel(total) {
            const badge = document.getElementById('maturity-badge');
            const desc = document.getElementById('maturity-desc');
            
            let levelClass = "";
            let levelText = "";
            let description = "";

            if (total === 0) {
                levelText = "بانتظار التقييم...";
                levelClass = "bg-gray-200 text-gray-600";
                description = "ابدأ باختيار الدرجات لكل مؤشر أعلاه.";
            } else if (total < 70) {
                levelText = "مرحلة التأسيس";
                levelClass = "bg-red-100 text-red-700 border border-red-200";
                description = "تحتاج المؤسسة إلى مراجعة شاملة للبنية التحتية والأساسية وبناء اللوائح والأنظمة.";
            } else if (total <= 125) {
                levelText = "مرحلة الانطلاق";
                levelClass = "bg-orange-100 text-orange-700 border border-orange-200";
                description = "العمل جيد ومبشر، ولكن يحتاج لتوثيق أكبر للممارسات وتفعيل أدوات قياس أعمق.";
            } else if (total <= 155) {
                levelText = "مرحلة النضج";
                levelClass = "bg-green-100 text-green-700 border border-green-200";
                description = "أداء عالٍ ومؤسسي مستقر، التركيز القادم يجب أن يكون على الابتكار والاستدامة.";
            } else {
                levelText = "مرحلة التميز";
                levelClass = "bg-teal-100 text-teal-800 border border-teal-200 shadow-md ring-2 ring-teal-400";
                description = "نموذج ريادي يُحتذى به. حافظ على القمة من خلال نشر المعرفة وقيادة القطاع.";
            }

            badge.className = `inline-block px-8 py-3 rounded-full text-lg font-bold transition-all duration-300 ${levelClass}`;
            badge.innerText = levelText;
            desc.innerText = description;
        }

        function animateValue(id, start, end, duration) {
            if (start === end) return;
            const range = end - start;
            let current = start;
            const increment = end > start ? 1 : -1;
            const stepTime = Math.abs(Math.floor(duration / range));
            const obj = document.getElementById(id);
            const timer = setInterval(function() {
                current += increment;
                obj.innerHTML = current;
                if (current == end) {
                    clearInterval(timer);
                }
            }, Math.max(stepTime, 20)); // Min 20ms
        }

        function resetForm() {
            if(confirm("هل أنت متأكد من رغبتك في إعادة تعيين النموذج؟")) {
                for (let member in scores) delete scores[member];
                renderApp();
                calculateTotals();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function toggleSection(contentId, iconId) {
            const content = document.getElementById(contentId);
            const icon = document.getElementById(iconId);
            
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                icon.classList.add('rotate-180');
            } else {
                content.classList.add('hidden');
                icon.classList.remove('rotate-180');
            }
        }

        // Initialize
        renderApp();
    </script>
</body>
</html>
